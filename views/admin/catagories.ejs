<%- include('head.ejs') %>
    
        <div class="productsNav mt-3 mb-5">
            <div class="searchBar">
                <input type="search" placeholder="Search for products by name or category" id="productSearch">
                <i class="las la-search"></i>
            </div>
            <button class="btn btn-success" id="openAddProduct">Add Catagory</button>
            
        </div>
    
    <div class="div tableWrapper">
        <table class="table table-light">
            <thead>
                <tr>
                    <th scope="col">#</th>
                    <!-- <th scope="col">Profile</th> -->
                    <th scope="col">Catagory</th>
                    
                    <!-- <th scope="col">Phone</th> -->
                    <th scope="col">block</th>
                    <th scope="col">un-block</th>
                    <!-- <th scope="col">edit</th> -->
                    <th scope="col">delete</th>
                    <th scope="col">Status</th>
                </tr>
            </thead>
            <tbody>
                <% users.map((user, index)=> { %>
                    <tr class="product-row">
                        <th scope="row">
                            <%= index + 1 %>
                        </th>
                        <!-- <td><img src="/assets/images/icons/logo.png"
                                style="width: 40px;height: 40px;object-fit: cover;border-radius: 10px;"></td> -->
                        <td class="user-name">
                            <%= user.catagory %>
                        </td>
                        <td>
                            <a href="/admin/block/<%= user.catagory %>" class="btn btn-warning delete-button"
                                style="width: 80px;">Block</a>
                        </td>
                        <td>
                            <a href="/admin/unblock/<%= user.catagory %>" class="btn btn-success delete-button"
                                style="width: 80px;">UnBlock</a>
                        </td>
                        <!-- <td>
                            <button class="btn btn-primary openEditBtn" style="width: 80px;" onclick="">Edit</button>
                        </td> -->
                        <td>
                            <a href="/admin/delete/<%= user.catagory %>" class="btn btn-danger delete-button"
                                onclick="return confirm('Are you sure you want to delete this catagory?')">Delete</a>
                        </td>
                        <td>
                            <% if(user.Blocked){ %>
                                <button class="btn btn-outline-danger" style="width: 80px;">blocked</button>
                                <% } else { %>
                                    <button class="btn btn-outline-primary" style="width: 80px;">active</button>
                                    <% } %>
                        </td>
                    </tr>
                    <% }); %>
            </tbody>
        </table>
    </div>
    <div class="popUp" style="display: none;">
        <div><button class="btn btn-danger closeBtn">close</button></div>
        <div class="formDiv">
            <h6 class="text-center">Add New Catagory</h6>
            <form action="/admin/addcatagory" method="post">
                <div class="mb-3">
                    <label class="form-label">Catagory</label>
                    <input type="text" class="form-control" id="fileUpload" name="catagory" required>
                </div>
                <div id="imagePreview"></div>
                <button type="submit" class="btn btn-primary">Add Catagory</button>
            </form>
        </div>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", () => {

            // Select the search input field
            const productSearchInput = document.getElementById('userSearch');

            // Select all product rows
            const productRows = document.querySelectorAll('.product-row');

            productSearchInput.addEventListener('input', () => {
                const searchTerm = productSearchInput.value.toLowerCase();

                // Loop through all product rows and hide those that don't match the search term
                productRows.forEach((row) => {
                    const productName = row.querySelector('.user-name').textContent.toLowerCase();
                    const productCategory = row.querySelector('.user-email').textContent.toLowerCase();

                    if (
                        productName.includes(searchTerm) ||
                        productCategory.includes(searchTerm)
                    ) {
                        row.style.display = 'table-row';
                    } else {
                        row.style.display = 'none';
                    }
                });
            });

        })
    </script>
    <script>
        $(document).ready(() => {
            $("#openAddProduct").click(() => {
                $(".popUp").toggle(300);
            })
            $(".closeBtn").click(() => {
                $(".popUp").toggle(300);
            })
        })
    </script>
    <%- include('foot.ejs') %>